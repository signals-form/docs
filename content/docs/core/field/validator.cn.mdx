---
title: 校验器
description: 灵活强大的表单字段校验系统
---

## 概述

在复杂表单场景中，校验系统需要考虑多个维度：校验规则、校验时机、校验结果处理、校验逻辑组合、校验上下文、校验流程控制等。SignalForm 提供了完整的校验器解决方案，通过 `defineValidator` 来定义灵活的校验器。

## 校验模式

SignalForm 支持两种校验模式：

### 主动式校验 (Initiative)
用户主动触发字段值变更时触发的校验，适用于实时反馈场景。

### 被动式校验 (Passive)  
当依赖的其他字段发生变化时触发的校验，适用于字段间关联校验。

```ts
const password = defineField({
  id: "password",
  component: Input,
  props: { 
    label: "密码", 
    type: "password", 
    prefix: "🔒", 
    required: true 
  },
  validators: [
    // 主动式校验 - 用户输入时触发
    defineValidator()
      .initiative()
      .schema(z.string({ message: "请输入密码！" })
        .min(6, "密码至少6位")
        .max(20, "密码不能超过20位")),
        
    // 被动式校验 - 依赖其他字段变化触发  
    defineValidator()
      .passive()
      .schema(z.string({ message: "请输入密码！" })
        .min(6, "密码至少6位")
        .max(20, "密码不能超过20位"))
  ]
})
```

> 💡 **提示**：不指定模式时，默认为主动式校验。后续示例主要演示主动式校验，两种模式的 API 完全一致。

## 校验规则定义

### 基础用法

SignalForm 没有内置通用校验规则，而是提供了灵活的校验器范式，让你可以轻松集成各种校验引擎。以 Zod 为例：

```ts
// 单个校验器
defineField({
  id: "username",
  component: Input,
  validators: defineValidator()
    .schema(z.string({ message: "请输入用户名！" })
      .min(3, "用户名至少3位")
      .max(20, "用户名不能超过20位"))
})

// 多个校验器
defineField({
  id: "email", 
  component: Input,
  validators: [
    defineValidator()
      .schema(z.string({ message: "请输入邮箱！" })
        .email("请输入有效的邮箱格式"))
  ]
})
```

### 简化语法

当只有一个校验器且无其他配置时，可以直接使用 schema：

```ts
defineField({
  id: "phone",
  component: Input,
  validators: z.string({ message: "请输入手机号！" })
    .regex(/^1[3-9]\d{9}$/, "请输入有效的手机号")
})
```
